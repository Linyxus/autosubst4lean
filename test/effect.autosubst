namespace Effect

kinds:
  var "x" => Exp
  tvar "X" => Ty
  evar "e"

inductive Eff : Sig -> Type
  | evar : BVar s .evar -> Eff s
  | pure : Eff s
  | io : Eff s
  | exn : Eff s
  | union : Eff s -> Eff s -> Eff s

inductive Ty : Sig -> Type
  | tvar : BVar s .tvar -> Ty s
  | arrow : Ty s -> Eff s -> Ty s -> Ty s
  | forall_ : Ty (s,X) -> Ty s
  | eforall : Ty (s,e) -> Ty s
  | prod : Ty s -> Ty s -> Ty s
  | sum : Ty s -> Ty s -> Ty s
  | unit : Ty s
  | handler : Eff s -> Eff s -> Ty s -> Ty s -> Ty s

inductive Exp : Sig -> Type
  | var : BVar s .var -> Exp s
  | abs : Ty s -> Exp (s,x) -> Exp s
  | app : Exp s -> Exp s -> Exp s
  | tabs : Exp (s,X) -> Exp s
  | tapp : Exp s -> Ty s -> Exp s
  | eabs : Exp (s,e) -> Exp s
  | eapp : Exp s -> Eff s -> Exp s
  | pair : Exp s -> Exp s -> Exp s
  | fst : Exp s -> Exp s
  | snd : Exp s -> Exp s
  | inl : Ty s -> Exp s -> Exp s
  | inr : Ty s -> Exp s -> Exp s
  | case_ : Exp s -> Exp (s,x) -> Exp (s,x) -> Exp s
  | perform : Eff s -> Exp s -> Exp s
  | handle : Exp s -> Exp (s,x) -> Exp s
  | letin : Exp s -> Exp (s,x) -> Exp s
  | unit : Exp s
